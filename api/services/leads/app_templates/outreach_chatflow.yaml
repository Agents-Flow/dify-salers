version: "0.5.0"
kind: app
app:
  name: "æ™ºèƒ½å¤–å±•å¯¹è¯æµ"
  mode: advanced-chat
  icon: "ğŸš€"
  icon_background: "#FFF0F5"
  description: "åŸºäºSOPçš„æ™ºèƒ½å¤–å±•å¯¹è¯æµã€‚è‡ªåŠ¨åˆ†æç”¨æˆ·æ„å›¾ï¼ŒæŒ‰ç…§é¢„è®¾æµç¨‹è¿›è¡Œå¯¹è¯ï¼Œæ”¯æŒå¤šè½®äº¤äº’å’Œäººå·¥æ¥å…¥ã€‚"
  use_icon_as_answer_icon: true

workflow:
  graph:
    nodes:
      - id: start
        type: start
        data:
          type: start
          title: å¯¹è¯å¼€å§‹
          variables:
            - variable: conversation_id
              label: å¯¹è¯ID
              type: text-input
              required: false
              default: ""
            - variable: kol_name
              label: KOLåç§°
              type: text-input
              required: false
              default: "CryptoKing"
            - variable: whatsapp_link
              label: WhatsAppé“¾æ¥
              type: text-input
              required: false
              default: "https://wa.me/..."
        position:
          x: 100
          y: 200

      - id: analyze
        type: tool
        data:
          type: tool
          title: åˆ†ææ„å›¾
          provider_id: social_outreach
          provider_type: builtin
          tool_name: analyze_intent
          tool_parameters:
            message:
              type: variable
              value:
                - sys
                - query
        position:
          x: 350
          y: 200

      - id: intent_router
        type: if-else
        data:
          type: if-else
          title: æ„å›¾è·¯ç”±
          conditions:
            - id: is_negative
              logical_operator: and
              conditions:
                - variable_selector:
                    - analyze
                    - json
                    - is_negative
                  comparison_operator: "=="
                  value: "true"
            - id: needs_human
              logical_operator: and
              conditions:
                - variable_selector:
                    - analyze
                    - json
                    - requires_human
                  comparison_operator: "=="
                  value: "true"
        position:
          x: 600
          y: 200

      - id: process_flow
        type: tool
        data:
          type: tool
          title: å¤„ç†å¯¹è¯æµ
          provider_id: social_outreach
          provider_type: builtin
          tool_name: process_conversation
          tool_parameters:
            conversation_id:
              type: variable
              value:
                - start
                - conversation_id
            incoming_message:
              type: variable
              value:
                - sys
                - query
            follower_name:
              type: constant
              value: "there"
            kol_name:
              type: variable
              value:
                - start
                - kol_name
            whatsapp_link:
              type: variable
              value:
                - start
                - whatsapp_link
        position:
          x: 850
          y: 100

      - id: polite_end
        type: llm
        data:
          type: llm
          title: ç¤¼è²Œç»“æŸ
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
            completion_params:
              temperature: 0.7
          prompt_template:
            - role: system
              text: |
                ç”Ÿæˆä¸€æ¡ç¤¼è²Œçš„ç»“æŸè¯­ï¼Œæ„Ÿè°¢ç”¨æˆ·çš„æ—¶é—´ã€‚ä¿æŒå‹å¥½å’Œä¸“ä¸šã€‚
            - role: user
              text: "ç”¨æˆ·è¯´ï¼š{{#sys.query#}}"
        position:
          x: 850
          y: 250

      - id: human_handoff
        type: llm
        data:
          type: llm
          title: äººå·¥è½¬æ¥
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
            completion_params:
              temperature: 0.5
          prompt_template:
            - role: system
              text: |
                ç”Ÿæˆä¸€æ¡è½¬æ¥äººå·¥çš„æ¶ˆæ¯ã€‚å‘Šè¯‰ç”¨æˆ·å°†æœ‰çœŸäººæ¥å¸®åŠ©ä»–ä»¬ã€‚
            - role: user
              text: "ç”¨æˆ·è¯´ï¼š{{#sys.query#}}"
        position:
          x: 850
          y: 400

      - id: response_answer
        type: answer
        data:
          type: answer
          title: å‘é€å›å¤
          answer: "{{#process_flow.text#}}"
        position:
          x: 1100
          y: 100

      - id: end_answer
        type: answer
        data:
          type: answer
          title: ç»“æŸå›å¤
          answer: "{{#polite_end.text#}}"
        position:
          x: 1100
          y: 250

      - id: handoff_answer
        type: answer
        data:
          type: answer
          title: è½¬æ¥å›å¤
          answer: "{{#human_handoff.text#}}\n\n[ç³»ç»Ÿæç¤ºï¼šè¯·è½¬æ¥äººå·¥å®¢æœ]"
        position:
          x: 1100
          y: 400

    edges:
      - source: start
        target: analyze
        sourceHandle: source
        targetHandle: target
      - source: analyze
        target: intent_router
        sourceHandle: source
        targetHandle: target
      - source: intent_router
        target: polite_end
        sourceHandle: is_negative
        targetHandle: target
      - source: intent_router
        target: human_handoff
        sourceHandle: needs_human
        targetHandle: target
      - source: intent_router
        target: process_flow
        sourceHandle: "else"
        targetHandle: target
      - source: process_flow
        target: response_answer
        sourceHandle: source
        targetHandle: target
      - source: polite_end
        target: end_answer
        sourceHandle: source
        targetHandle: target
      - source: human_handoff
        target: handoff_answer
        sourceHandle: source
        targetHandle: target

  features:
    opening_statement: |
      ğŸ‘‹ æ¬¢è¿ä½¿ç”¨æ™ºèƒ½å¤–å±•å¯¹è¯æµï¼
      
      æˆ‘ä¼šè‡ªåŠ¨åˆ†æç”¨æˆ·çš„å›å¤æ„å›¾ï¼Œå¹¶æŒ‰ç…§SOPæµç¨‹ç”Ÿæˆåˆé€‚çš„å›å¤ã€‚
      
      è¯·è¾“å…¥ç”¨æˆ·å‘æ¥çš„æ¶ˆæ¯ï¼Œæˆ‘æ¥å¸®ä½ å¤„ç†ã€‚

    suggested_questions:
      - "Hi, sounds interesting!"
      - "Why should I join your group?"
      - "Is this a scam?"
      - "Sure, send me the link!"

    suggested_questions_after_answer:
      enabled: true

    speech_to_text:
      enabled: false

    text_to_speech:
      enabled: false

    file_upload:
      enabled: false

    sensitive_word_avoidance:
      enabled: false
