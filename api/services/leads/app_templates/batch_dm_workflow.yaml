version: "0.5.0"
kind: app
app:
  name: "æ‰¹é‡DMè‡ªåŠ¨åŒ–"
  mode: workflow
  icon: "ğŸ“¨"
  icon_background: "#FFF8DC"
  description: "æ‰¹é‡å‘é€ä¸ªæ€§åŒ–DMæ¶ˆæ¯ã€‚æ”¯æŒSpintaxæ¨¡æ¿ã€å®šæ—¶å‘é€å’Œæ™ºèƒ½é¢‘ç‡æ§åˆ¶ã€‚"
  use_icon_as_answer_icon: false

workflow:
  graph:
    nodes:
      - id: start
        type: start
        data:
          type: start
          title: é…ç½®ä»»åŠ¡
          variables:
            - variable: kol_id
              label: ç›®æ ‡KOL ID
              type: text-input
              required: true
            - variable: message_category
              label: æ¶ˆæ¯ç±»åˆ«
              type: select
              required: true
              options:
                - opening
                - follow_up
                - conversion
              default: opening
            - variable: target_count
              label: å‘é€æ•°é‡
              type: number
              required: false
              default: 50
              min: 1
              max: 200
            - variable: kol_name
              label: KOLåç§°(ç”¨äºæ¶ˆæ¯)
              type: text-input
              required: false
              default: "our team"
            - variable: whatsapp_link
              label: WhatsAppé“¾æ¥
              type: text-input
              required: false
              default: ""
        position:
          x: 100
          y: 200

      - id: generate_template
        type: tool
        data:
          type: tool
          title: ç”Ÿæˆæ¶ˆæ¯æ¨¡æ¿
          provider_id: social_outreach
          provider_type: builtin
          tool_name: generate_message
          tool_parameters:
            template_category:
              type: variable
              value:
                - start
                - message_category
            follower_name:
              type: constant
              value: "[follower_name]"
            kol_name:
              type: variable
              value:
                - start
                - kol_name
            whatsapp_link:
              type: variable
              value:
                - start
                - whatsapp_link
        position:
          x: 350
          y: 200

      - id: preview
        type: llm
        data:
          type: llm
          title: é¢„è§ˆæ¶ˆæ¯
          model:
            provider: openai
            name: gpt-4o-mini
            mode: chat
            completion_params:
              temperature: 0.3
          prompt_template:
            - role: system
              text: |
                è¯·ç¡®è®¤ä»¥ä¸‹DMæ¶ˆæ¯æ¨¡æ¿æ˜¯å¦åˆé€‚ï¼š
                
                æ¶ˆæ¯å†…å®¹ï¼š{{#generate_template.text#}}
                
                å¦‚æœåˆé€‚ï¼Œå›å¤"ç¡®è®¤"ã€‚å¦‚æœæœ‰é—®é¢˜ï¼ŒæŒ‡å‡ºé—®é¢˜ã€‚
            - role: user
              text: "è¯·æ£€æŸ¥æ¶ˆæ¯æ¨¡æ¿"
        position:
          x: 600
          y: 200

      - id: create_task
        type: tool
        data:
          type: tool
          title: åˆ›å»ºæ‰¹é‡ä»»åŠ¡
          provider_id: social_outreach
          provider_type: builtin
          tool_name: create_outreach_task
          tool_parameters:
            task_type:
              type: constant
              value: dm
            target_kol_id:
              type: variable
              value:
                - start
                - kol_id
            target_count:
              type: variable
              value:
                - start
                - target_count
            priority:
              type: constant
              value: normal
        position:
          x: 850
          y: 200

      - id: end
        type: end
        data:
          type: end
          title: ä»»åŠ¡åˆ›å»ºå®Œæˆ
          outputs:
            - variable: task_id
              value_selector:
                - create_task
                - json
                - task_id
            - variable: message_preview
              value_selector:
                - generate_template
                - text
            - variable: target_count
              value_selector:
                - start
                - target_count
            - variable: status
              value_selector:
                - create_task
                - json
                - status
        position:
          x: 1100
          y: 200

    edges:
      - source: start
        target: generate_template
        sourceHandle: source
        targetHandle: target
      - source: generate_template
        target: preview
        sourceHandle: source
        targetHandle: target
      - source: preview
        target: create_task
        sourceHandle: source
        targetHandle: target
      - source: create_task
        target: end
        sourceHandle: source
        targetHandle: target

  features:
    file_upload:
      enabled: false
    opening_statement: ""
    suggested_questions: []
    sensitive_word_avoidance:
      enabled: false
    text_to_speech:
      enabled: false
    speech_to_text:
      enabled: false
